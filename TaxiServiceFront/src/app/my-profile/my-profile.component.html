<div *ngIf="!loaded" class="profile">
  Page is loading
</div>


<div *ngIf="loaded">

<div *ngIf="showInfo">
  <div class="buttons">
    <ul>
      <li>
        <button (click)="EditUser()"><i>Change Username</i></button>
      </li>
      <li>
        <button (click)="EditPassword()"><i>Change Password</i></button>
      </li>
      <li>
        <button (click)="Edit()"><i>Edit Profile</i></button>
      </li>
    </ul>
  </div>

  <div class="profile">
  
    <tr style=" text-align: center;">
      <td ><h2 style="font-weight: bold;">{{activeUser.Username}}</h2></td>
      <td style=" text-align: center;">{{activeUser.FullName}}</td>
    </tr>
    <tr>
      <td><h3>Email:</h3></td>
      <td>{{activeUser.Email}}</td>
    </tr>
    <tr>
      <td><h3>Gender:</h3></td>
      <td>{{activeUser.Gender}}</td>
    </tr>
    <tr>
      <td><h3>JMBG:</h3></td>
      <td>{{activeUser.JMBG || "Not entered"}}</td>
    </tr>
    <tr>
      <td><h3>Contact Number:</h3></td>
      <td>{{activeUser.ContactNumber || "Not entered"}}</td>
    </tr>
    <tr>
      <td><h3>Role:</h3></td>
      
      <td>{{activeUser.Role}}</td>
    </tr>

  </div>
</div>

<div *ngIf="showUser" class="sC">
    <h3 class="prop">Change your username</h3>
    <div *ngIf="errorUnique" class="errorText">Username is not avaible, please choose another</div>
    <div *ngIf="errorUsername" class="errorText">Error while trying to change username, please try again</div>
    <form [formGroup]="editUsernameForm" (ngSubmit)="OnSubmitUsername()">
      <label>Username:</label>
      <input type="text" formControlName="username"/>
      <div *ngIf="submitted && u.username.errors"  class="errorText">
        <div *ngIf="u.username.errors.required">Username is required</div>
      </div>
      <button [disabled]="submitted">Change</button>
      <button (click)="Cancel()">Cancel</button>
  </form>
</div>

<div *ngIf="showPassword" class="sC">
    <div *ngIf="showError" class="errorText">Error while trying to change your password, please try again</div>
    <h3 class="prop">Change your password</h3>
  <form [formGroup]="editPasswordForm" (ngSubmit)="OnSubmitPassword()">
      <label>Old Password</label><br/>
    <input type="password" formControlName="oldPassword"/>
    <div *ngIf="submitted && p.oldPassword.errors"  class="errorText">
      <div *ngIf="p.oldPassword.errors.required">Old Password is required</div>
    </div>
    <div>
    <label>Password</label><br/>
    <input type="password" formControlName="password" />
    <div *ngIf="submitted && p.password.errors" class="errorText">
        <div *ngIf="p.password.errors.required">New Password is required</div>
        <div *ngIf="editPasswordForm.controls['password'].hasError('hasNumber')">Must have at least one number</div>
        <div *ngIf="editPasswordForm.controls['password'].hasError('hasCapitalCase')">Must have at least one upper case letter</div>
        <div *ngIf="editPasswordForm.controls['password'].hasError('hasSmallCase')">Must have at least one lower case letter</div>
        <div *ngIf="editPasswordForm.controls['password'].hasError('hasSpecialCharacters')">Must have at least one special character</div>
        <div *ngIf="editPasswordForm.controls['password'].hasError('minlength')">Must be at least 6 character long</div>
      </div>
    </div>

    <div>
        <label>Confirm Password</label><br/>
        <input type="password" formControlName="confirmPassword" />
        <div *ngIf="submitted && p.confirmPassword.errors" class="errorText">
            <div *ngIf="p.confirmPassword.errors.required">Confirm Password is required</div>
        </div>
    </div>
    <div class="errorText" *ngIf="editPasswordForm.controls.confirmPassword.errors?.MatchPassword">Password not match</div>
  
    <button [disabled]="submitted">Change</button>
    <button (click)="Cancel()">Cancel</button>
  </form>
</div>

<div *ngIf="showEdit">
    <div class="profile">
      <form [formGroup]="editForm" (ngSubmit)="OnSubmit()">
        <!-- <tr>
            <td><h3 class="prop">Username:</h3></td>
        </tr>
        <tr>
          <td>
              <input type="text" formControlName="username"/>
              <div *ngIf="submitted && f.username.errors"  class="errorText">
                <div *ngIf="f.username.errors.required">Username is required</div>
            </div>
          </td>
        </tr> -->

        <tr>
            <td><h3 class="prop">FullName:</h3></td>
        </tr>
        <tr>
          <td>
              <input type="text" formControlName="fullname"/>
              <div *ngIf="submitted && f.fullname.errors"  class="errorText">
                <div *ngIf="f.fullname.errors.required">FullName is required</div>
            </div>
          </td>
        </tr>

        <tr>
            <td><h3 class="prop">Gender:</h3></td>
        </tr>
        <tr>
          <td>
              <select id="gender" formControlName="gender">
                  <option *ngFor="let g of genders" [ngValue]="g">{{ g }}</option>
              </select>
          </td>
        </tr>

        <tr>
            <td><h3 class="prop">JMBG:</h3></td>
        </tr>
        <tr>
          <td>
              <input type="text" formControlName="jmbg"/>
          </td>
        </tr>

        <tr>
            <td><h3 class="prop">Contact Number:</h3></td>
        </tr>
        <tr>
          <td>
              <input type="text" formControlName="contactNumber"/>
          </td>
        </tr>

        <tr>
          <button [disabled]="submitted">Edit</button>
          <button (click)="Cancel()">Cancel</button>
        </tr>

      </form>
        
      
    
    </div>
</div>
</div>